import{a as ie,f as _e}from"../chunks/BniqZkh8.js";import{o as He,w as Le}from"../chunks/Bwg8BZCB.js";import{j as O,a0 as Ce,aD as Me,C as Re,h as ue,a2 as ce,X as De,A as d,aE as Oe,a8 as $e,al as ye,aw as de,k as Z,a7 as ze,aB as Be,ak as Ee,b as V,aF as $,i as ge,aG as Ge,l as qe,aH as Ve,aI as Je,az as be,aJ as Pe,aK as Xe,z as Ye,a6 as Se,aL as Ke,d as xe,g as Ne,aM as fe,aN as Qe,ay as We,e as je,au as Ze,o as et,u as Ae,aO as tt,aP as rt,q as at,aQ as st,p as nt,f as ot,a as lt,c as M,s as S,r as H,B as G,aR as ke,aS as ee,t as Ie}from"../chunks/CUh3aHkV.js";import{d as it,a as q,s as ut,e as ve}from"../chunks/DRIANX0T.js";import{B as ct}from"../chunks/hEhOE4Xy.js";import{T as dt,r as te,s as ft}from"../chunks/BgO_1IPt.js";import{b as vt,s as pt,a as mt}from"../chunks/CQE0r639.js";const gt=Symbol("NaN");function ht(e,o,l){O&&Ce();var f=new ct(e),p=!Me();Re(()=>{var r=o();r!==r&&(r=gt),p&&r!==null&&typeof r=="object"&&(r={}),f.ensure(r,l)})}function _t(e,o){return o}function bt(e,o,l){for(var f=[],p=o.length,r,u=o.length,t=0;t<p;t++){let v=o[t];Ne(v,()=>{if(r){if(r.pending.delete(v),r.done.add(v),r.pending.size===0){var _=e.outrogroups;he(be(r.done)),_.delete(r),_.size===0&&(e.outrogroups=null)}}else u-=1},!1)}if(u===0){var c=f.length===0&&l!==null;if(c){var a=l,m=a.parentNode;We(m),m.append(a),e.items.clear()}he(o,!c)}else r={pending:new Set(o),done:new Set},(e.outrogroups??=new Set).add(r)}function he(e,o=!0){for(var l=0;l<e.length;l++)je(e[l],o)}var Te;function wt(e,o,l,f,p,r=null){var u=e,t=new Map;{var c=e;u=O?ce(De(c)):c.appendChild(ue())}O&&Ce();var a=null,m=Ve(()=>{var h=l();return Je(h)?h:h==null?[]:be(h)}),v,_=!0;function z(){k.fallback=a,yt(k,v,u,o,f),a!==null&&(v.length===0?(a.f&$)===0?xe(a):(a.f^=$,Y(a,null,u)):Ne(a,()=>{a=null}))}var s=Re(()=>{v=d(m);var h=v.length;let C=!1;if(O){var w=Oe(u)===$e;w!==(h===0)&&(u=ye(),ce(u),de(!1),C=!0)}for(var L=new Set,I=V,R=qe(),E=0;E<h;E+=1){O&&Z.nodeType===ze&&Z.data===Be&&(u=Z,C=!0,de(!1));var N=v[E],b=f(N,E),T=_?null:t.get(b);T?(T.v&&Ee(T.v,N),T.i&&Ee(T.i,E),R&&I.unskip_effect(T.e)):(T=Et(t,_?u:Te??=ue(),N,b,E,p,o,l),_||(T.e.f|=$),t.set(b,T)),L.add(b)}if(h===0&&r&&!a&&(_?a=ge(()=>r(u)):(a=ge(()=>r(Te??=ue())),a.f|=$)),h>L.size&&Ge(),O&&h>0&&ce(ye()),!_)if(R){for(const[J,K]of t)L.has(J)||I.skip_effect(K.e);I.oncommit(z),I.ondiscard(()=>{})}else z();C&&de(!0),d(m)}),k={effect:s,items:t,outrogroups:null,fallback:a};_=!1,O&&(u=Z)}function X(e){for(;e!==null&&(e.f&Qe)===0;)e=e.next;return e}function yt(e,o,l,f,p){var r=o.length,u=e.items,t=X(e.effect.first),c,a=null,m=[],v=[],_,z,s,k;for(k=0;k<r;k+=1){if(_=o[k],z=p(_,k),s=u.get(z).e,e.outrogroups!==null)for(const b of e.outrogroups)b.pending.delete(s),b.done.delete(s);if((s.f&$)!==0)if(s.f^=$,s===t)Y(s,null,l);else{var h=a?a.next:t;s===e.effect.last&&(e.effect.last=s.prev),s.prev&&(s.prev.next=s.next),s.next&&(s.next.prev=s.prev),D(e,a,s),D(e,s,h),Y(s,h,l),a=s,m=[],v=[],t=X(a.next);continue}if((s.f&fe)!==0&&xe(s),s!==t){if(c!==void 0&&c.has(s)){if(m.length<v.length){var C=v[0],w;a=C.prev;var L=m[0],I=m[m.length-1];for(w=0;w<m.length;w+=1)Y(m[w],C,l);for(w=0;w<v.length;w+=1)c.delete(v[w]);D(e,L.prev,I.next),D(e,a,L),D(e,I,C),t=C,a=I,k-=1,m=[],v=[]}else c.delete(s),Y(s,t,l),D(e,s.prev,s.next),D(e,s,a===null?e.effect.first:a.next),D(e,a,s),a=s;continue}for(m=[],v=[];t!==null&&t!==s;)(c??=new Set).add(t),v.push(t),t=X(t.next);if(t===null)continue}(s.f&$)===0&&m.push(s),a=s,t=X(s.next)}if(e.outrogroups!==null){for(const b of e.outrogroups)b.pending.size===0&&(he(be(b.done)),e.outrogroups?.delete(b));e.outrogroups.size===0&&(e.outrogroups=null)}if(t!==null||c!==void 0){var R=[];if(c!==void 0)for(s of c)(s.f&fe)===0&&R.push(s);for(;t!==null;)(t.f&fe)===0&&t!==e.fallback&&R.push(t),t=X(t.next);var E=R.length;if(E>0){var N=r===0?l:null;bt(e,R,N)}}}function Et(e,o,l,f,p,r,u,t){var c=(u&Pe)!==0?(u&Xe)===0?Ye(l,!1,!1):Se(l):null,a=(u&Ke)!==0?Se(p):null;return{v:c,i:a,e:ge(()=>(r(o,c??l,a??p,t),()=>{e.delete(f)}))}}function Y(e,o,l){if(e.nodes)for(var f=e.nodes.start,p=e.nodes.end,r=o&&(o.f&$)===0?o.nodes.start:l;f!==null;){var u=Ze(f);if(r.before(f),f===p)return;f=u}}function D(e,o,l){o===null?e.effect.first=l:o.next=l,l===null?e.effect.last=o:l.prev=o}function St(e,o,l){et(()=>{var f=Ae(()=>o(e,l?.())||{});if(f?.destroy)return()=>f.destroy()})}function re(e,o,l=o){var f=new WeakSet;tt(e,"input",async p=>{var r=p?e.defaultValue:e.value;if(r=pe(e)?me(r):r,l(r),V!==null&&f.add(V),await rt(),r!==(r=o())){var u=e.selectionStart,t=e.selectionEnd,c=e.value.length;if(e.value=r??"",t!==null){var a=e.value.length;u===t&&t===c&&a>c?(e.selectionStart=a,e.selectionEnd=a):(e.selectionStart=u,e.selectionEnd=Math.min(t,a))}}}),(O&&e.defaultValue!==e.value||Ae(o)==null&&e.value)&&(l(pe(e)?me(e.value):e.value),V!==null&&f.add(V)),at(()=>{var p=o();if(e===document.activeElement){var r=st??V;if(f.has(r))return}pe(e)&&p===me(e.value)||e.type==="date"&&!p&&!e.value||p!==e.value&&(e.value=p??"")})}function pe(e){var o=e.type;return o==="number"||o==="range"}function me(e){return e===""?null:+e}var kt=_e('<video class="gif-video svelte-1m7wss9" loop="" playsinline="" disablepictureinpicture=""><source type="video/mp4"/></video>',2),It=_e('<div class="gif-container svelte-1m7wss9"><!> <p class="svelte-1m7wss9"> </p> <div class="button-wrapper svelte-1m7wss9"><button class="copy-discord-button svelte-1m7wss9">Copy Discord URL</button> <button class="copy-button svelte-1m7wss9">Copy URL</button> <button class="close-button svelte-1m7wss9">X</button></div></div>'),Tt=_e('<!> <div id="controls" class="svelte-1m7wss9"><div id="data-button-container" class="svelte-1m7wss9"><button id="export-button" class="svelte-1m7wss9">Export GIFs</button> <button id="import-button" class="svelte-1m7wss9">Import GIFs</button></div> <div id="search" class="svelte-1m7wss9"><input type="text" placeholder="Search for a GIF..." id="search-input" class="svelte-1m7wss9"/></div> <br/> <div id="add" class="svelte-1m7wss9"><input type="text" placeholder="URL" id="add-input" class="svelte-1m7wss9"/> <input type="text" placeholder="Discord URL (optional)" id="add-discord-url-input" class="svelte-1m7wss9"/> <input type="text" placeholder="Tags (space separated)" id="add-tags-input" class="svelte-1m7wss9"/> <button id="add-button" class="svelte-1m7wss9">Add</button></div></div> <div id="video-container" class="svelte-1m7wss9"></div>',1);function Ht(e,o){nt(o,!0);const l=()=>mt(r,"$gifsStore",f),[f,p]=pt(),r=Le([]);let u=ee(""),t=ee(""),c=ee(""),a=ee(""),m,v,_=ke(()=>d(u).split(" ").map(n=>n.trim()).filter(n=>n!=="")),z=ke(()=>l().filter(n=>d(_).every(i=>n.tags.some(g=>g.toLowerCase().includes(i.toLowerCase())))));function s(){if(d(t).trim()===""||d(a).trim()===""){alert("Please enter both URL and tags.");return}let n=d(a).split(" ").map(i=>i.trim()).filter(i=>i!=="");n.length!==0&&(r.update(i=>{const g={url:d(t).trim(),tags:n,discordUrl:d(c).trim()===""?d(t).trim():d(c).trim()};return[...i,g]}),G(t,""),G(a,""),G(c,""))}function k(){const n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(l())),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","gifs.json"),document.body.appendChild(i),i.click(),i.remove()}function h(n,i){const g=[...n];return i.forEach(y=>{g.some(x=>x.url===y.url&&x.discordUrl===y.discordUrl)||g.push(y)}),g}function C(){const n=document.createElement("input");n.type="file",n.accept="application/json",n.onchange=i=>{const g=i.target.files?.[0];if(!g)return;const y=new FileReader;y.onload=x=>{try{const A=JSON.parse(x.target?.result);r.update(P=>h(P,A))}catch(A){alert("Failed to import: "+A)}},y.readAsText(g)},n.click()}function w(n){const i=window.getComputedStyle(m),g=parseInt(i.getPropertyValue("grid-auto-rows")),y=parseInt(i.getPropertyValue("gap")),x=n.querySelector("video");if(!x)return;const A=x.offsetHeight,P=n.querySelector("p")?n.querySelector("p").offsetHeight:0,Q=n.querySelector(".button-wrapper")?n.querySelector(".button-wrapper").offsetHeight:0,W=A+P+Q+10,j=Math.ceil((W+y)/(g+y));n.style.gridRowEnd=`span ${j}`}function L(n){return v.observe(n),{destroy(){v.unobserve(n)}}}He(()=>{v=new ResizeObserver(i=>{for(const g of i)w(g.target)});const n=localStorage.getItem("gifs");return n&&r.set(JSON.parse(n)),r.subscribe(i=>{localStorage.setItem("gifs",JSON.stringify(i))}),()=>{v.disconnect()}});var I=Tt(),R=ot(I);dt(R,{});var E=S(R,2),N=M(E),b=M(N),T=S(b,2);H(N);var J=S(N,2),K=M(J);te(K),H(J);var we=S(J,4),ae=M(we);te(ae);var se=S(ae,2);te(se);var ne=S(se,2);te(ne);var Ue=S(ne,2);H(we),H(E);var oe=S(E,2);wt(oe,21,()=>d(z),_t,(n,i,g)=>{var y=It(),x=M(y);ht(x,()=>d(i).url,U=>{var F=kt();F.muted=!0;var le=M(F);H(F),St(F,B=>L?.(B)),Ie(()=>ft(le,"src",d(i).url)),ve("mouseenter",F,B=>B.currentTarget.play()),ve("mouseleave",F,B=>B.currentTarget.pause()),ve("loadedmetadata",F,B=>{w(B.currentTarget.parentElement)}),ie(U,F)});var A=S(x,2),P=M(A);H(A);var Q=S(A,2),W=M(Q),j=S(W,2),Fe=S(j,2);H(Q),H(y),Ie(U=>ut(P,`Tags: ${U??""}`),[()=>d(i).tags.join(", ")]),q("click",W,()=>{navigator.clipboard.writeText(d(i).discordUrl||d(i).url).then(()=>alert("Discord URL copied!")).catch(U=>alert("Failed to copy: "+U))}),q("click",j,()=>{navigator.clipboard.writeText(d(i).url).then(()=>alert("URL copied!")).catch(U=>alert("Failed to copy: "+U))}),q("click",Fe,()=>{confirm(`Delete this GIF?
URL: ${d(i).url}
Discord URL: ${d(i).discordUrl}
Tags: ${d(i).tags.join(", ")}`)&&r.update(U=>U.filter((F,le)=>le!==g))}),ie(n,y)}),H(oe),vt(oe,n=>m=n,()=>m),q("click",b,k),q("click",T,C),re(K,()=>d(u),n=>G(u,n)),re(ae,()=>d(t),n=>G(t,n)),re(se,()=>d(c),n=>G(c,n)),re(ne,()=>d(a),n=>G(a,n)),q("click",Ue,s),ie(e,I),lt(),p()}it(["click"]);export{Ht as component};
